@import "../../../../vendor/filament/filament/resources/css/theme.css";

@config 'tailwind.config.js';

@layer utilities {
    /* Custom max content width - 90% instead of full width */
    .fi-main.max-w-full {
        max-width: 94% !important;
    }

    /* Ensure global loader is above everything */
    #global-loader {
        z-index: 9999 !important;
    }

    /* Primary buttons: ensure readable text */
    .fi-btn.fi-btn-color-primary,
    .fi-btn.fi-btn-color-primary * {
        color: rgb(78 29 4) !important;
    }

    .fi-modal-close-overlay {
        /* Ensure overlays sit above modal content */
        z-index: 80 !important;
    }

    /* Modal root containers also need higher stacking to cover content */
    .fi-modal .fixed.inset-0 {
        z-index: 90 !important; /* above overlay */
    }

    /* Create a higher stacking context for the modal wrapper itself */
    .fi-modal-window {
        position: relative;
        z-index: 90;
    }

    /* Custom styles for increased table row height */
    .fi-table-row {
        height: 9rem !important;
    }

    .fi-table-row > td {
        vertical-align: middle;
        padding-top: 1rem;
        padding-bottom: 1rem;
    }

    /* Ensure global search field and results are above other elements */
    .fi-global-search {
        position: relative;
        z-index: 30;
    }

    /* Increase width of the global search field */
    .fi-global-search .fi-input-wrp {
        width: 10rem !important; /* w-80 - increased from default */
        min-width: 10rem !important;
    }

    /* Responsive width adjustments */
    @media (min-width: 640px) {
        .fi-global-search .fi-input-wrp {
            width: 14rem !important; /* w-96 on sm and up */
            min-width: 14rem !important;
        }
    }

    @media (min-width: 1024px) {
        .fi-global-search .fi-input-wrp {
            width: 18rem !important; /* w-112 on lg and up */
            min-width: 18rem !important;
        }
    }

    .fi-global-search-results-ctn {
        z-index: 50 !important;
    }

    /* Custom placement for Filament Language Switch Outside Panel (Admin) */
    .fls-display-on {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 50;
        display: flex;
        justify-content: center; /* centers child horizontally */
        padding: 1rem;
        pointer-events: none; /* optional, allows clicks to pass through */
    }

    /* Enable interaction for inner content */
    .fls-display-on > * {
        pointer-events: auto; /* enable interaction for inner content */
    }

    /* Hide the repeater-collapsible toolbar */
    .no-repeater-collapse-toolbar .fi-link {
        display: none !important;
    }

    /* Global Search Modal Styles for DT */
    .global-search-modal-details .inline.font-medium {
        font-size: 0.75rem !important;
    }

    /* Global Search Modal Details for DD */
    .global-search-modal-details .inline {
        font-size: 0.75rem !important;
    }

    /* Force override using more specific selectors */
    .fi-page .ff-column {
        background-color: rgb(255 255 255 / 0.3) !important;
        --tw-bg-opacity: 1 !important;
        backdrop-filter: blur(4px) !important;
    }

    /* Dark mode Flowforge Kanban column: force background color */
    .fi-page .dark .ff-column,
    .fi-page .ff-column:is(.dark *) {
        background-color: rgb(34 39 43 / 0.8) !important;
        --tw-bg-opacity: 1 !important;
    }

    /* Dark mode Flowforge Kanban card: force background color */
    .ff-card:is(.dark *) {
        background-color: rgb(41 47 51) !important;
        border-color: rgb(250 250 250 / 0.1) !important;
    }

    /* Dark mode Flowforge Kanban card: force border color on hover */
    .ff-card:is(.dark *):hover {
        border-color: rgb(250 250 250 / 0.25) !important;
    }

    /* Action Board: remove vertical scrolling on the page when Flowforge board is present */
    @media (min-width: 1024px) {
        .fi-main:has(.ff-board),
        .fi-page:has(.ff-board) {
            overflow-y: hidden !important;
        }

        /* Ensure the main container fills the viewport to avoid stray scrollbars */
        .fi-main:has(.ff-board) {
            min-height: 80vh;
            max-height: 90vh;
        }
    }

    /* Action Board: clamp each column's internal scroll area to avoid page-level scrollbars */
    .fi-page:has(.ff-board) .ff-board__columns {
        overflow-y: hidden;
    }

    /* Tighten column content height relative to viewport to be below the page chrome */
    .fi-page:has(.ff-board) .ff-column__content {
        max-height: calc(100vh - 17rem) !important;
    }

    /* Final guard: disable body vertical scroll when the board is present */
    body:has(.ff-board),
    html:has(.ff-board) {
        overflow-y: hidden !important;
        height: 100%;
    }

    /* Explicit board sizing so page + board fits viewport without page scroll */
    .fi-page .ff-board {
        height: calc(100vh - 12.5rem) !important;
    }

    /* Ensure columns region fills the board height and enables horizontal scrolling - synced with global theme */
    .fi-page .ff-board__columns {
        height: 100% !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        display: flex !important;
        gap: 1rem !important;
        padding: 1rem !important;
        scrollbar-width: thin !important;
        scrollbar-color: rgb(161 161 170) transparent !important; /* zinc-400 - synced with global */
    }

    /* Custom scrollbar styling for horizontal scrolling - synced with global theme */
    .fi-page .ff-board__columns::-webkit-scrollbar {
        height: 8px !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-track {
        background: transparent !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-thumb {
        background: rgb(
            161 161 170
        ) !important; /* zinc-400 - synced with global */
        border-radius: 4px !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-thumb:hover {
        background: rgb(
            113 113 122
        ) !important; /* zinc-500 - synced with global */
    }

    /* Remove scrollbar buttons (arrows) for horizontal scrolling */
    .fi-page .ff-board__columns::-webkit-scrollbar-button {
        display: none !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-corner {
        display: none !important;
    }

    /* Columns respect the board height and maintain proper width for horizontal scrolling */
    .fi-page .ff-column {
        max-height: 90% !important;
    }

    /* Enable vertical scrolling for column content - synced with global theme */
    .fi-page .ff-column__content {
        overflow-y: auto !important;
        overflow-x: hidden !important;
        flex: 1 1 auto !important;
        max-height: calc(100% - 3.25rem) !important;
        scrollbar-width: thin !important;
        scrollbar-color: rgb(161 161 170) transparent !important; /* zinc-400 - synced with global */
    }

    /* Custom vertical scrollbar styling for column content - synced with global theme */
    .fi-page .ff-column__content::-webkit-scrollbar {
        width: 6px !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-track {
        background: transparent !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-thumb {
        background: rgb(
            161 161 170
        ) !important; /* zinc-400 - synced with global */
        border-radius: 3px !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-thumb:hover {
        background: rgb(
            113 113 122
        ) !important; /* zinc-500 - synced with global */
    }

    /* Remove scrollbar buttons (arrows) for vertical scrolling */
    .fi-page .ff-column__content::-webkit-scrollbar-button {
        display: none !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-corner {
        display: none !important;
    }

    /* While drag-scrolling, prevent text selection cursor and highlight */
    .ff-drag-scrolling,
    .ff-drag-scrolling * {
        user-select: none !important;
        cursor: grabbing !important;
        cursor: -webkit-grabbing !important;
    }

    /* User mention highlighting styles - for rich text editors */
    .user-mention,
    mark.user-mention {
        background-color: #dbeafe !important; /* blue-100 */
        color: #1e40af !important; /* blue-800 */
        padding: 0.25rem 0.5rem !important;
        border-radius: 0.375rem !important;
        font-weight: 500 !important;
        border: 1px solid #bfdbfe !important; /* blue-200 */
        text-decoration: none !important;
        display: inline !important;
    }

    /* Dark mode user mention styles */
    .dark .user-mention,
    .dark mark.user-mention {
        background-color: #1e3a8a !important; /* blue-900 */
        color: #bfdbfe !important; /* blue-200 */
        border-color: #1d4ed8 !important; /* blue-700 */
    }

    /* Ensure mentions work in Trix editor specifically */
    trix-editor .user-mention,
    trix-editor mark.user-mention {
        background-color: #dbeafe !important;
        color: #1e40af !important;
        padding: 0.25rem 0.5rem !important;
        border-radius: 0.375rem !important;
        font-weight: 500 !important;
        border: 1px solid #bfdbfe !important;
        text-decoration: none !important;
        display: inline !important;
    }

    /* Dark mode Trix editor mention styling */
    .dark trix-editor .user-mention,
    .dark trix-editor mark.user-mention {
        background-color: #1e3a8a !important;
        color: #bfdbfe !important;
        border-color: #1d4ed8 !important;
    }

    /* Trix editor mention styling using data attributes */
    trix-editor [data-mention="true"] {
        background-color: #dbeafe !important;
        color: #1e40af !important;
        font-weight: 600 !important;
        border-radius: 0.25rem !important;
        padding: 0.125rem 0.25rem !important;
        border: 1px solid #bfdbfe !important;
    }

    /* Dark mode Trix editor mention styling using data attributes */
    .dark trix-editor [data-mention="true"] {
        background-color: #1e3a8a !important;
        color: #bfdbfe !important;
        border-color: #1d4ed8 !important;
    }

    /* Cover image row styling for user table */
    .cover-image-row {
        position: relative;
        background-size: cover !important;
        background-position: center !important;
        background-repeat: no-repeat !important;
        border: 1px solid #e5e7eb !important;
        filter: brightness(1) !important; /* Bright by default */
    }

    /* Cover image row: hover effect */
    .cover-image-row:hover {
        filter: brightness(0.95) !important; /* Dark on hover */
    }

    /* Dark mode cover image row: hover effect */
    .dark .cover-image-row:hover {
        filter: brightness(1.2) !important; /* Bright on hover */
    }

    /* Dark mode cover image row: force border color */
    .dark .cover-image-row {
        border: none !important;
    }

    /* Remove top border from first cover image row to eliminate extra line */
    .cover-image-row:first-child {
        border-top: none !important;
        border-right: none !important;
        border-left: none !important;
    }

    /* Remove all borders from consecutive cover image rows to create seamless background */
    .cover-image-row + .cover-image-row {
        border: none !important;
    }

    /* Ensure last cover image row has bottom border for proper closure */
    .cover-image-row:last-child {
        border: none !important;
    }

    /* Text styling for cover image rows */
    .cover-image-row .fi-table-row-cell {
        color: white !important;
        position: relative;
        z-index: 10;
        padding-top: 8px !important;
        padding-bottom: 8px !important;
        vertical-align: middle !important;
    }

    /* Ensure all content within table cells is above gradient */
    .cover-image-row .fi-table-row-cell * {
        position: relative;
        z-index: 11;
    }

    /* Dark mode adjustments for cover image rows */
    .dark .cover-image-row .fi-table-row-cell {
        color: white !important;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.9) !important;
    }

    .dark .cover-image-row .fi-avatar {
        border-color: rgba(255, 255, 255, 0.9) !important;
    }

    /* User table row border styling */
    .user-table-row-border {
        border: none !important;
    }

    /* Dark mode user table row border styling */
    .dark .user-table-row-border {
        border: none !important;
    }

    /* Hover effect for user table rows */
    .user-table-row-border:hover {
        border: none !important;
    }

    /* Dark mode hover effect for user table rows */
    .dark .user-table-row-border:hover {
        border: none !important;
    }

    /* Hide the default sidebar collapse button */
    .fi-sidebar-header .fi-icon-btn.ms-auto,
    .fi-sidebar-header .fi-icon-btn.mx-auto,
    .fi-sidebar-header button[aria-label*="collapse"],
    .fi-sidebar-header button[aria-label*="expand"],
    .fi-sidebar-header button[title*="collapse"],
    .fi-sidebar-header button[title*="expand"],
    .fi-sidebar-header button[class*="chevron"],
    /* More specific selectors */
    .fi-sidebar .fi-sidebar-header .fi-icon-btn.ms-auto,
    .fi-sidebar .fi-sidebar-header .fi-icon-btn.mx-auto,
    .fi-sidebar .fi-sidebar-header button[aria-label*="collapse"],
    .fi-sidebar .fi-sidebar-header button[aria-label*="expand"],
    /* Target any button with chevron icons in sidebar header */
    .fi-sidebar-header button svg[data-lucide="chevron-left"],
    .fi-sidebar-header button svg[data-lucide="chevron-right"],
    .fi-sidebar-header button [data-lucide="chevron-left"],
    .fi-sidebar-header button [data-lucide="chevron-right"] {
        display: none !important;
    }

    /* Custom sidebar footer styling - Chatbox-inspired design */
    .fi-sidebar-footer {
        @apply flex items-center justify-start p-4;
    }

    .fi-sidebar-collapse-button,
    .fi-sidebar-expand-button {
        @apply w-12 h-12 flex items-center justify-center rounded-lg transition-all duration-200 cursor-pointer;
        @apply shadow-lg hover:shadow-xl bg-primary-500;
        @apply opacity-80 hover:opacity-100;
        @apply border border-primary-500 dark:border-primary-500;
        @apply focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2;
    }

    .fi-sidebar-collapse-button-icon,
    .fi-sidebar-expand-button-icon {
        @apply w-6 h-6 text-primary-900 transition-all duration-200;
    }

    .fi-sidebar-collapse-button:hover .fi-sidebar-collapse-button-icon,
    .fi-sidebar-expand-button:hover .fi-sidebar-expand-button-icon {
        @apply text-primary-900 dark:text-primary-900;
    }

    /* Active state for better visual feedback */
    .fi-sidebar-collapse-button:active,
    .fi-sidebar-expand-button:active {
        @apply transform scale-95 shadow-md;
    }

    /* Sidebar sizing reductions - reduce text and icon sizes while preserving badges and chevrons */

    /* Reduce grouping text size */
    .fi-sidebar-group-label {
        font-size: 0.75rem !important;
        line-height: 1rem !important;
    }

    /* Reduce item icon size */
    .fi-sidebar-item-icon {
        height: 1.25rem !important;
        width: 1.25rem !important;
    }

    .fi-sidebar-item:not(.fi-active):hover .fi-sidebar-item-icon {
        @apply text-gray-500 dark:text-gray-200;
    }

    /* Reduce group icon size */
    .fi-sidebar-group-icon {
        height: 1.25rem !important;
        width: 1.25rem !important;
    }

    /* Reduce item label text size */
    .fi-sidebar-item-label {
        font-size: 0.75rem !important;
        line-height: 1rem !important;
    }

    /* Reduce padding for more compact sidebar items - only when sidebar is collapsed */
    .fi-sidebar:not(.fi-sidebar-open) .fi-sidebar-item-button {
        padding: 0.85rem 0.5rem !important;
    }

    /* Reduce padding for group buttons */
    .fi-sidebar-group-button {
        padding: 0.375rem 0.5rem !important;
    }

    /* Reduce gap between elements in sidebar items */
    .fi-sidebar-item-button {
        gap: 0.85rem !important;
    }

    /* Ensure badges maintain their size - override any inheritance */
    .fi-sidebar-item-button .fi-badge,
    .fi-sidebar-group-button .fi-badge,
    .fi-sidebar-item-button [class*="badge"],
    .fi-sidebar-group-button [class*="badge"] {
        font-size: 0.75rem !important;
        padding: 0.125rem 0.375rem !important;
        min-height: 1.25rem !important;
    }

    /* Ensure chevron icons maintain their size */
    .fi-sidebar-group-collapse-button svg,
    .fi-sidebar-group-collapse-button [class*="icon"],
    .fi-sidebar-group-collapse-button .fi-icon {
        height: 1rem !important;
        width: 1rem !important;
    }

    /* Action Board: remove vertical scrolling on the page when Flowforge board is present */
    @media (min-width: 1024px) {
        .fi-main:has(.ff-board),
        .fi-page:has(.ff-board) {
            overflow-y: hidden !important;
        }

        /* Ensure the main container fills the viewport to avoid stray scrollbars */
        .fi-main:has(.ff-board) {
            min-height: 80vh;
            max-height: 90vh;
        }
    }
}
