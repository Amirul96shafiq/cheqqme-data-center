@import "../../../../vendor/filament/filament/resources/css/theme.css";

@config 'tailwind.config.js';

@layer utilities {
    /* Neutral palette swap: force Zinc neutrals in dark mode */
    .dark {
        /* Filament/Tailwind often reference gray/slate tokens; align both to Zinc */
        --color-gray-50: 250 250 250; /* zinc-50 */
        --color-gray-100: 244 244 245; /* zinc-100 */
        --color-gray-200: 228 228 231; /* zinc-200 */
        --color-gray-300: 212 212 216; /* zinc-300 */
        --color-gray-400: 161 161 170; /* zinc-400 */
        --color-gray-500: 113 113 122; /* zinc-500 */
        --color-gray-600: 82 82 91; /* zinc-600 */
        --color-gray-700: 63 63 70; /* zinc-700 */
        --color-gray-800: 39 39 42; /* zinc-800 */
        --color-gray-900: 24 24 27; /* zinc-900 */
        --color-slate-50: var(--color-gray-50);
        --color-slate-100: var(--color-gray-100);
        --color-slate-200: var(--color-gray-200);
        --color-slate-300: var(--color-gray-300);
        --color-slate-400: var(--color-gray-400);
        --color-slate-500: var(--color-gray-500);
        --color-slate-600: var(--color-gray-600);
        --color-slate-700: var(--color-gray-700);
        --color-slate-800: var(--color-gray-800);
        --color-slate-900: var(--color-gray-900);
    }

    /* Dark mode primary buttons: ensure readable white text */
    .dark .fi-btn.fi-btn-color-primary,
    .dark .fi-btn.fi-btn-color-primary * {
        color: #ffffff !important;
    }

    .fi-modal-close-overlay {
        /* Ensure overlays sit above custom fixed sidebar */
        z-index: 80 !important;
    }

    /* Modal root containers also need higher stacking to cover the sidebar */
    .fi-modal .fixed.inset-0 {
        z-index: 90 !important; /* above overlay */
    }

    /* Create a higher stacking context for the modal wrapper itself */
    .fi-modal-window {
        position: relative;
        z-index: 90;
    }

    /* Custom styles for increased table row height */
    .fi-table-row {
        height: 9rem !important;
    }

    .fi-table-row > td {
        vertical-align: middle;
        padding-top: 1rem;
        padding-bottom: 1rem;
    }

    /* Database notifications slide-over lives inside the modal window; ensure it stacks above overlay */
    .fi-modal-window.fi-modal-slide-over-window {
        z-index: 90 !important;
    }

    /* Also ensure the notifications trigger panel stays below overlays */
    .fi-topbar,
    .fi-sidebar {
        z-index: 20;
    }

    /* Custom placement for Filament Language Switch Outside Panel (Admin) */
    .fls-display-on {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 50;
        display: flex;
        justify-content: center; /* centers child horizontally */
        padding: 1rem;
        pointer-events: none; /* optional, allows clicks to pass through */
    }

    /* Enable interaction for inner content */
    .fls-display-on > * {
        pointer-events: auto; /* enable interaction for inner content */
    }

    /* Hide the repeater-collapsible toolbar */
    .no-repeater-collapse-toolbar .fi-link {
        display: none !important;
    }

    /* Global Search Modal Styles for DT */
    .global-search-modal-details .inline.font-medium {
        font-size: 0.75rem !important;
    }
    
    /* Global Search Modal Details for DD */
    .global-search-modal-details .inline {
        font-size: 0.75rem !important;
    }

    /* Language switch header trigger: force white background */
    .language-switch-trigger {
        background-color: #ffffff !important;
        /* Fallback: inset shadow border ensures visibility even if cascade issues */
        box-shadow: inset 0 0 0 1px rgb(3 7 18 / 0.1),
            0 1px 2px 0 rgb(0 0 0 / 0.04);
    }

    /* Language switch header trigger: hover and focus styles */
    .language-switch-trigger:hover,
    .language-switch-trigger:focus-visible {
        box-shadow: inset 0 0 0 1px rgb(3 7 18 / 0.2),
            0 1px 2px 0 rgb(0 0 0 / 0.06);
    }

    /* Dark mode language switch header trigger: force white background */
    .dark .language-switch-trigger {
        background-color: rgb(255 255 255 / 0.05) !important;
        border: 1px solid rgb(255 255 255 / 0.2) !important;
        box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.3);
    }
    /* Flowforge Kanban card title normal weight (lean override) */
    .ff-card__title {
        font-weight: 400 !important;
    }

    /* Dark mode Flowforge Kanban card: force background color */
    .ff-card:is(.dark *) {
        background-color: #22272b90 !important;
        border-color: rgb(250 250 250 / 0.1) !important;
    }

    /* Force sidebar to pin on large screens, with full viewport height */
    @media (min-width: 1024px) {
        /* Pin the sidebar */
        .fi-main-sidebar.fi-sidebar,
        .fi-main-sidebar .fi-sidebar {
            position: fixed !important;
            top: 0;
            inset-inline-start: 0;
            height: 100vh;
            z-index: 10 !important; /* keep under modal overlays */
        }

        /* Reserve space for the fixed sidebar */
        .fi-main-ctn {
            margin-inline-start: var(--sidebar-width) !important;
        }

        /* Action Board: remove vertical scrolling on the page when Flowforge board is present */
        .fi-main:has(.ff-board),
        .fi-page:has(.ff-board) {
            overflow-y: hidden !important;
        }

        /* Ensure the main container fills the viewport to avoid stray scrollbars */
        .fi-main:has(.ff-board) {
            min-height: 80vh;
            max-height: 90vh;
        }
    }

    /* Action Board: clamp each column's internal scroll area to avoid page-level scrollbars */
    .fi-page:has(.ff-board) .ff-board__columns {
        overflow-y: hidden;
    }

    /* Tighten column content height relative to viewport to be below the page chrome */
    .fi-page:has(.ff-board) .ff-column__content {
        max-height: calc(100vh - 17rem) !important;
    }

    /* Final guard: disable body vertical scroll when the board is present */
    body:has(.ff-board),
    html:has(.ff-board) {
        overflow-y: hidden !important;
        height: 100%;
    }

    /* Explicit board sizing so page + board fits viewport without page scroll */
    .fi-page .ff-board {
        height: calc(100vh - 12.5rem) !important;
    }

    /* Ensure columns region fills the board height and enables horizontal scrolling */
    .fi-page .ff-board__columns {
        height: 100% !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        display: flex !important;
        gap: 1rem !important;
        padding: 1rem !important;
        scrollbar-width: thin !important;
        scrollbar-color: rgb(161 161 170) transparent !important;
    }

    /* Custom scrollbar styling for horizontal scrolling */
    .fi-page .ff-board__columns::-webkit-scrollbar {
        height: 8px !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-track {
        background: transparent !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-thumb {
        background: rgb(161 161 170) !important;
        border-radius: 4px !important;
    }

    .fi-page .ff-board__columns::-webkit-scrollbar-thumb:hover {
        background: rgb(113 113 122) !important;
    }

    /* Columns respect the board height and maintain proper width for horizontal scrolling */
    .fi-page .ff-column {
        max-height: 90% !important;
    }

    /* Enable vertical scrolling for column content */
    .fi-page .ff-column__content {
        overflow-y: auto !important;
        overflow-x: hidden !important;
        flex: 1 1 auto !important;
        max-height: calc(100% - 3.25rem) !important;
        scrollbar-width: thin !important;
        scrollbar-color: rgb(161 161 170) transparent !important;
    }

    /* Custom vertical scrollbar styling for column content */
    .fi-page .ff-column__content::-webkit-scrollbar {
        width: 6px !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-track {
        background: transparent !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-thumb {
        background: rgb(161 161 170) !important;
        border-radius: 3px !important;
    }

    .fi-page .ff-column__content::-webkit-scrollbar-thumb:hover {
        background: rgb(113 113 122) !important;
    }

    /* While drag-scrolling, prevent text selection cursor and highlight */
    .ff-drag-scrolling,
    .ff-drag-scrolling * {
        user-select: none !important;
        cursor: grabbing !important;
        cursor: -webkit-grabbing !important;
    }

    /* User mention highlighting styles - for rich text editors */
    .user-mention,
    mark.user-mention {
        background-color: #dbeafe !important; /* blue-100 */
        color: #1e40af !important; /* blue-800 */
        padding: 0.25rem 0.5rem !important;
        border-radius: 0.375rem !important;
        font-weight: 500 !important;
        border: 1px solid #bfdbfe !important; /* blue-200 */
        text-decoration: none !important;
        display: inline !important;
    }

    /* Dark mode user mention styles */
    .dark .user-mention,
    .dark mark.user-mention {
        background-color: #1e3a8a !important; /* blue-900 */
        color: #bfdbfe !important; /* blue-200 */
        border-color: #1d4ed8 !important; /* blue-700 */
    }

    /* Ensure mentions work in Trix editor specifically */
    trix-editor .user-mention,
    trix-editor mark.user-mention {
        background-color: #dbeafe !important;
        color: #1e40af !important;
        padding: 0.25rem 0.5rem !important;
        border-radius: 0.375rem !important;
        font-weight: 500 !important;
        border: 1px solid #bfdbfe !important;
        text-decoration: none !important;
        display: inline !important;
    }

    /* Dark mode Trix editor mention styling */
    .dark trix-editor .user-mention,
    .dark trix-editor mark.user-mention {
        background-color: #1e3a8a !important;
        color: #bfdbfe !important;
        border-color: #1d4ed8 !important;
    }

    /* Trix editor mention styling using data attributes */
    trix-editor [data-mention="true"] {
        background-color: #dbeafe !important;
        color: #1e40af !important;
        font-weight: 600 !important;
        border-radius: 0.25rem !important;
        padding: 0.125rem 0.25rem !important;
        border: 1px solid #bfdbfe !important;
    }

    /* Dark mode Trix editor mention styling using data attributes */
    .dark trix-editor [data-mention="true"] {
        background-color: #1e3a8a !important;
        color: #bfdbfe !important;
        border-color: #1d4ed8 !important;
    }

    /* Cover image row styling for user table */
    .cover-image-row {
        position: relative;
        background-size: cover !important;
        background-position: center !important;
        background-repeat: no-repeat !important;
        border: 1px solid #e5e7eb !important;
        filter: brightness(1) !important; /* Bright by default */
    }

    /* Cover image row: hover effect */
    .cover-image-row:hover {
        filter: brightness(0.95) !important; /* Dark on hover */
    }

    /* Dark mode cover image row: hover effect */
    .dark .cover-image-row:hover {
        filter: brightness(1.2) !important; /* Bright on hover */
    }

    /* Dark mode cover image row: force border color */
    .dark .cover-image-row {
        border-color: #2f2f32 !important;
    }

    /* Remove top border from first cover image row to eliminate extra line */
    .cover-image-row:first-child {
        border-top: none !important;
        border-right: none !important;
        border-left: none !important;
    }

    /* Remove all borders from consecutive cover image rows to create seamless background */
    .cover-image-row + .cover-image-row {
        border: none !important;
    }

    /* Ensure last cover image row has bottom border for proper closure */
    .cover-image-row:last-child {
        border-bottom: 1px solid #e5e7eb !important;
    }

    /* Text styling for cover image rows */
    .cover-image-row .fi-table-row-cell {
        color: white !important;
        position: relative;
        z-index: 10;
        padding-top: 8px !important;
        padding-bottom: 8px !important;
        vertical-align: middle !important;
    }

    /* Ensure all content within table cells is above gradient */
    .cover-image-row .fi-table-row-cell * {
        position: relative;
        z-index: 11;
    }

    /* Dark mode adjustments for cover image rows */
    .dark .cover-image-row .fi-table-row-cell {
        color: white !important;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.9) !important;
    }

    .dark .cover-image-row .fi-avatar {
        border-color: rgba(255, 255, 255, 0.9) !important;
    }
}
